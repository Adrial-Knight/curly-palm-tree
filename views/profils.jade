extend layout
block left
  h1.mb-5.text-center="Vos posts"
  div.row
  each article in owned
    div.container.row.mb-5
      div.col-1.align-self-center.text-center.my-text-align-justify
        if (article.v_vote != undefined)
          if (article.v_vote == 1)
            form(action="/profils/0/vote/cancel/"+user.u_id+"/"+article.a_id+"/article/-1/"+(article.a_score - 1),method="post")
              button.mb-2="cancel"
            h4.text-success=article.a_score
            form(action="/profils/0/vote/udapte/"+user.u_id+"/"+article.a_id+"/article/-1/"+(article.a_score - 2),method="post")
              button="down"
          if (article.v_vote == -1)
            form(action="/profils/0/vote/udapte/"+user.u_id+"/"+article.a_id+"/article/1/"+(article.a_score + 2),method="post")
              button.mb-2="up"
            h4.text-danger=article.a_score
            form(action="/profils/0/vote/cancel/"+user.u_id+"/"+article.a_id+"/article/+1/"+(article.a_score + 1),method="post")
              button="cancel"
        else
          form(action="/profils/0/vote/new/"+user.u_id+"/"+article.a_id+"/article/1/"+(article.a_score + 1),method="post")
            button.mb-2="up"
          h4=article.a_score
          form(action="/profils/0/vote/new/"+user.u_id+"/"+article.a_id+"/article/-1/"+(article.a_score - 1),method="post")
            button="down"
      div.col-11
        div.row
          if ( (edit != null) && (edit.id == article.a_id) )
            form.row(action="/profils/0/edite/article/"+article.a_id+"/saved",method="post")
              div.col-10
                input.col-12(type="text", minlength="1", maxlength="255", required="required", placeholder="Titre",name="new_title", value=edit.title)
                div.row
                input.col-6(type="text", minlength="1", maxlength="255", required="required", placeholder="Lien",name="link", value=edit.link)
                input.col-6(type="text", minlength="1", maxlength="255", required="required", placeholder="Sub-reddit",name="sub", value=edit.sub)
                div.row
                textarea.col-12(type="text", rows="5", minlength="1", maxlength="40000", required="required", placeholder="Contenu",name="content")=edit.content
              div.col-2
                button.col-12.mb-4.mt-4="Sauvegarder"
                div.row
                form(action="foo")
                form(action="/profils/0/edite/article/"+article.a_id+"/cancel",method="post")
                  button.col-12.mb-2="Annuler"
                div.row
                form(action="/profils/0/edite/article/"+article.a_id+"/del",method="post")
                  button.col-12="Supprimer"
          else
            a.col-9.text-decoration-none.text-dark(href="/article/"+article.a_id+"?reset=edit")
              h4=user.u_pseudo + ", le " +article.a_date
              h3=article.a_title
              if (article.a_reaction > 1)
                h5=article.a_reaction + " commentaires"
              else
                h5=article.a_reaction + " commentaire"
            div.col-3
              div.row
                if (edit == null)
                  form.col-6(action="/profils/0/edite/article/"+article.a_id+"/processing",method="post")
                    button="Editer"
                  form.col-6(action="/profils/0/del/article/"+article.a_id,method="post")
                    button="Supprimer"
    
  h1.mb-5.text-center="Les autres posts auxquels vous avez réagis"
  div.row
    -var com_index = 0
    each article in reacted
      div.container.row.mb-5
        div.col-1.align-self-center.text-center.my-text-align-justify
          if (article.v_vote != undefined)
            if (article.v_vote == 1)
              form(action="/profils/0/vote/cancel/"+user.u_id+"/"+article.a_id+"/article/-1/"+(article.a_score - 1),method="post")
                button.mb-2="cancel"
              h4.text-success=article.a_score
              form(action="/profils/0/vote/udapte/"+user.u_id+"/"+article.a_id+"/article/-1/"+(article.a_score - 2),method="post")
                button="down"
            if (article.v_vote == -1)
              form(action="/profils/0/vote/udapte/"+user.u_id+"/"+article.a_id+"/article/1/"+(article.a_score + 2),method="post")
                button.mb-2="up"
              h4.text-danger=article.a_score
              form(action="/profils/0/vote/cancel/"+user.u_id+"/"+article.a_id+"/article/+1/"+(article.a_score + 1),method="post")
                button="cancel"
          else
            form(action="/profils/0/vote/new/"+user.u_id+"/"+article.a_id+"/article/1/"+(article.a_score + 1),method="post")
              button.mb-2="up"
            h4=article.a_score
            form(action="/profils/0/vote/new/"+user.u_id+"/"+article.a_id+"/article/-1/"+(article.a_score - 1),method="post")
              button="down"
        div.col-11
          div.row
            if ( (edit != null) && (edit.id == article.a_id) )
              form.row(action="/profils/0/edite/article/"+article.a_id+"/saved",method="post")
                div.col-10
                  input.col-12(type="text", minlength="1", maxlength="255", required="required", placeholder="Titre",name="new_title", value=edit.title)
                  div.row
                  input.col-6(type="text", minlength="1", maxlength="255", required="required", placeholder="Lien",name="link", value=edit.link)
                  input.col-6(type="text", minlength="1", maxlength="255", required="required", placeholder="Sub-reddit",name="sub", value=edit.sub)
                  div.row
                  textarea.col-12(type="text", rows="5", minlength="1", maxlength="40000", required="required", placeholder="Contenu",name="content")=edit.content
                div.col-2
                  button.col-12.mb-4.mt-4="Sauvegarder"
                  div.row
                  form(action="foo")
                  form(action="/profils/0/edite/article/"+article.a_id+"/cancel",method="post")
                    button.col-12.mb-2="Annuler"
                  div.row
                  form(action="/profils/0/edite/article/"+article.a_id+"/del",method="post")
                    button.col-12="Supprimer"
            else
              a.col-9.text-decoration-none.text-dark(href="/article/"+article.a_id+"?reset=edit")
                h4=article.u_pseudo + ", le " +article.a_date
                h3=article.a_title
                if (article.a_reaction > 1)
                  h5=article.a_reaction + " commentaires"
                else
                  h5=article.a_reaction + " commentaire"
              div.col-3
                div.row
                if ( (edit == null) && (article.a_user == user.u_id) )
                    form.col-6(action="/profils/0/edite/article/"+article.a_id+"/processing",method="post")
                      button="Editer"
                    form.col-6(action="/profils/0/del/article/"+article.a_id,method="post")
                      button="Supprimer"
        div.row
          div.col-1
          div.col-11.mb-3
            h4= "Vos commentaires: "
        - while ((comments_in_reacted[com_index] != undefined) && (article.a_id == comments_in_reacted[com_index].a_id))
          - nb_comment++
            div.row.mb-3
              div.col-1
              div.col-1.text-center
                if (comments_in_reacted[com_index].v_vote != undefined)
                  if (comments_in_reacted[com_index].v_vote == 1)
                    form(action="/profils/0/vote/cancel/"+user.u_id+"/"+comments_in_reacted[com_index].c_id+"/comment/-1/"+(comments_in_reacted[com_index].c_score - 1),method="post")
                      button.mb-2="cancel"
                    h4.text-success=comments_in_reacted[com_index].c_score
                    form(action="/profils/0/vote/udapte/"+user.u_id+"/"+comments_in_reacted[com_index].c_id+"/comment/-1/"+(comments_in_reacted[com_index].c_score - 2),method="post")
                      button="down"
                  if (comments_in_reacted[com_index].v_vote == -1)
                    form(action="/profils/0/vote/udapte/"+user.u_id+"/"+comments_in_reacted[com_index].c_id+"/comment/1/"+(comments_in_reacted[com_index].c_score + 2),method="post")
                      button.mb-2="up"
                    h4.text-danger=comments_in_reacted[com_index].c_score
                    form(action="/profils/0/vote/cancel/"+user.u_id+"/"+comments_in_reacted[com_index].c_id+"/comment/+1/"+(comments_in_reacted[com_index].c_score + 1),method="post")
                      button="cancel"
                else
                  form(action="/profils/0/vote/new/"+user.u_id+"/"+comments_in_reacted[com_index].c_id+"/comment/1/"+(comments_in_reacted[com_index].c_score + 1),method="post")
                    button.mb-2="up"
                  h4=comments_in_reacted[com_index].c_score
                  form(action="/profils/0/vote/new/"+user.u_id+"/"+comments_in_reacted[com_index].c_id+"/comment/-1/"+(comments_in_reacted[com_index].c_score - 1),method="post")
                    button="down"
              div.col-10
                if (edit == null)
                  div.row
                    div.col-9
                      p= comments_in_reacted[com_index].c_content
                    div.col-3
                      nav.nav.nav-pills.fs-7.lh-1.justify-content-end
                        form(action="/profils/"+article.a_id+"/edite/comment/"+comments_in_reacted[com_index].c_id+"/processing",method="post")
                          button.nav-link.bg-dark.rounded-pill.text-info.mb-2="Editer"
                        form(action="/profils/"+article.a_id+"/del/comment/"+comments_in_reacted[com_index].c_id,method="post")
                          button.nav-link.bg-danger.rounded-pill.text-white.mb-2="Supprimer"
                else if ( (edit.kind == "comment") && (comments_in_reacted[com_index].c_id == edit.id) )
                  form(action="/profils/"+article.a_id+"/edite/comment/"+comments_in_reacted[com_index].c_id+"/saved",method="post")
                    textarea.col-12(type="text", rows="7", minlength="1", maxlength="40000", required="required", placeholder="Contenu",name="content")=edit.content
                    nav.nav.nav-pills.fs-7.lh-1.justify-content-end
                      button.nav-link.bg-success.rounded-pill.text-white.mb-2="Valider"
                      form(action="foo")
                      form(action="/profils/"+article.a_id+"/edite/comment/"+comments_in_reacted[com_index].c_id+"/cancel",method="post")
                        button.nav-link.bg-warning.rounded-pill.text-white.mb-2="Annuler"
                      form(action="/profils/"+article.a_id+"/edite/comment/"+comments_in_reacted[com_index].c_id+"/del",method="post")
                        button.nav-link.bg-danger.rounded-pill.text-white.mb-2="Supprimer"
          - com_index = com_index + 1
block right
  h1.mb-5.text-center="Vos informations"
  h4="Pseudo: "+user.u_pseudo
  h4="Mail: "+user.u_mail
  h4.mt-4="Nombre de contribution: "+(owned.length + comments_in_reacted.length)
  h4="Dernière connexion le "+user.u_connexion
